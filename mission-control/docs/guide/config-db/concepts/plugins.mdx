---
title: Plugins
sidebar_custom_props:
  icon: octicon:gear
---

Scrape Plugins are resources that modify the behavior of other scrapers. 
They can transform changes, add properties to configs, and even set up relationships between configs. 
These behaviors can also be defined on a ScrapeConfig, but using a scrape plugin makes them global, eliminating the need to define them in all scrapers.

For example, if you want to exclude all events with severity="info", a scrape plugin can help you achieve that.

```yaml title="scrape-plugin.yaml"
apiVersion: configs.flanksource.com/v1
kind: ScrapePlugin
metadata:
  name: exclude-info-level-changes
  namespace: mc
spec:
  changes:
    exclude:
    - severity == "info"
```


### Spec

<Fields
  rows={[
    {
      field: 'relationship',
      description: 'Select all the components to link to this check',
      scheme: '[Relationships](./relationships)'
    },
    {
      field: 'properties',
      description: 'Custom templatable properties for the scraped config items.',
      scheme: '[`[]ConfigProperty`](/reference/config-db/properties)'
    },
    {
      field: 'changes.exclude',
      description: 'Ignore changes',
      scheme: '[[]CEL](#exclusions) with [Change Context](/reference/config-db/changes)'
    },
    {
      field: 'changes.mapping',
      description: 'Categorize changes',
      scheme: '[Mapping](#mapping)'
    }

  ]}
/>


### Mapping

When you encounter a diff change, unlike an event-based change, it can sometimes appear unclear. The summary of the change may not immediately indicate its purpose. For example, the change 'status.images' might not be self-explanatory. To clarify this, you can assign types to these diff changes using mapping.

```yaml title="scrape-plugin.yaml"
apiVersion: configs.flanksource.com/v1
kind: ScrapePlugin
metadata:
  name: exclude-info-level-changes
  namespace: mc
spec:
  changes:
    //highlight-start
    mapping:
      - filter: >
          change.change_type == 'diff' && change.summary == "status.containerStatuses" &&
          patch != null && has(patch.status) && has(patch.status.containerStatuses) &&
          patch.status.containerStatuses.size() > 0 &&
          has(patch.status.containerStatuses[0].restartCount)
        type: PodCrashLooping
      - filter: >
          change.change_type == 'diff' && change.summary == "status.images" && config.kind == "Node"
        type: ImageUpdated
        //highlight-end
```

| Field     | Description                                                                                            | Scheme                                                                                                   |
| --------- | ------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------- |
| `filter`  | Selects changes to apply the mapping                                                                   | <CommonLink to="cel">CEL</CommonLink> with [Change Context](/reference/config-db/changes)                |
| `action`  | What action to take on the change, if `delete` then the corresponding config item is marked as deleted | `delete` or `ignore`                                                                                     |
| `type`    | New change type                                                                                        | `string`                                                                                                 |
| `summary` | New summary of the change                                                                              | <CommonLink to="gotemplate">Go Template</CommonLink> with [Change Context](/reference/config-db/changes) |